<template>
  <div>
    <Dialog
      header=" "
      v-model:visible="isAddFileSurveyArea"
      class="w-full md:w-5/6 lg:w-2/3 xl:w-1/2">
      <div>
      <p class="text-center text-xl font-bold">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà</p>
      <input type="file" ref="fileInput" @change="">
      </div>
        <div class="flex justify-end">
          <button
            @click="submitAddFileSurveyArea"
            class="bg-blue-500 text-white p-2 rounded  hover:bg-blue-700 s">
            ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô
          </button>
        </div>
    </Dialog>
    <!-- ‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà -->

    <Dialog
      header=" "
      v-model:visible="isAddImgProcess"
      
      class="w-full md:w-5/6 lg:w-2/3 xl:w-1/2">
      <div>
      <p class="text-center text-xl font-bold">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏π‡∏õ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</p>
      <input type="file" ref="fileInput" @change="">
      </div>
        <div class="flex justify-end">
          <button
            @click="submitAddFileSurveyArea"
            class="bg-blue-500 text-white p-2 rounded  hover:bg-blue-700 s">
            ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô
          </button>
        </div>
    </Dialog>
    <!-- ‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏π‡∏õ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô -->

    <Dialog
      header=" "
      v-model:visible="isAddImgTest"
      
      class="w-full md:w-5/6 lg:w-2/3 xl:w-1/2">
      <div>
      <p class="text-center text-xl font-bold">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏π‡∏õ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö</p>
      <input type="file" ref="fileInput" @change="">
      </div>
        <div class="flex justify-end">
          <button
            @click="submitAddFileSurveyArea"
            class="bg-blue-500 text-white p-2 rounded  hover:bg-blue-700 s">
            ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô
          </button>
        </div>
    </Dialog>
    <!-- ‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏π‡∏õ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö -->
    <Dialog
      header=" "
      v-model:visible="isAddImgDeliverJob"
      
      class="w-full md:w-5/6 lg:w-2/3 xl:w-1/2">
      <div>
      <p class="text-center text-xl font-bold">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏π‡∏õ‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö‡∏á‡∏≤‡∏ô</p>
      <input type="file" ref="fileInput" @change="">
      </div>
        <div class="flex justify-end">
          <button
            @click="submitAddFileSurveyArea"
            class="bg-blue-500 text-white p-2 rounded  hover:bg-blue-700 s">
            ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô
          </button>
        </div>
    </Dialog>
    <!-- ‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏π‡∏õ‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö‡∏á‡∏≤‡∏ô -->

    <Dialog
      v-model:visible="showEditProjectModal"
      :modal="true"
      class="w-full md:w-5/6 lg:w-2/3 xl:w-1/2"
      header="‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ"
    >
      <form class="px-4 sm:px-10 mt-2 sm:mt-5">
        <div class="grid gap-3 sm:gap-6 mb-3 sm:mb-6 md:grid-cols-1">
          <div>
            <label
              for="projectTitle"
              class="block mb-1 sm:mb-2 text-xs sm:text-base font-medium text-gray-900"
              >‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ</label
            >
            <input
              v-model="editedProject.type_name"
              type="text"
              id="projectTitle"
              class="bg-gray-50 border border-gray-300 text-gray-900 text-xs sm:text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2 sm:p-2.5"
              placeholder=""
              required/>
          </div>
        </div>
        <div class="flex justify-end">
          <button
            @click="submitEditProject"
            class="bg-blue-500 text-white p-2 rounded  hover:bg-blue-700 s">
            ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
          </button>
        </div>
      </form>
    </Dialog>

    <div class="flex flex-wrap bg-cyan-200 md:h-[100vh] h-[130vh]">
      <div class="w-full px-3 mb-6 mx-auto">
        <div
          class="relative flex-[1_auto] flex flex-col break-words min-w-0 bg-clip-border rounded-[.95rem] bg-zinc-100 m-5"
        >
          <div class="shadow-xl">
            <!-- card header -->
            <div
              class="px-9 pt-5 flex justify-between items-stretch flex-wrap min-h-[70px] pb-0 bg-transparent">
              <h3
                class="flex flex-col items-start justify-center m-2 ml-0 font-medium text-xl/tight text-dark">
              <!-- ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏´‡∏•‡∏±‡∏Å -->
                <span class="mr-3 font-semibold text-dark text-3xl">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</span>  
                
              </h3>
            </div>

            <div class="mx-10 py-2 space-y-2">

<div style="margin-top: 20px;">
  <button @click="getImageData">üîÑ ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏à‡∏≤‡∏Å‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå</button>
</div>

<!-- üñº ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà‡πÇ‡∏´‡∏•‡∏î‡∏°‡∏≤ -->
<div v-if="image_iden && typeof image_iden === 'string'" style="margin-top: 10px;">
  <p>ü™™ ‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô:</p>
  <img :src="image_iden" alt="‡∏£‡∏π‡∏õ‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô" style="max-width: 300px;" />
</div>

<div v-if="image_bank && typeof image_bank === 'string'" style="margin-top: 10px;">
  <p>üè¶ ‡∏™‡∏°‡∏∏‡∏î‡∏ö‡∏±‡∏ç‡∏ä‡∏µ:</p>
  <img :src="image_bank" alt="‡∏£‡∏π‡∏õ‡∏™‡∏°‡∏∏‡∏î‡∏ö‡∏±‡∏ç‡∏ä‡∏µ" style="max-width: 300px;" />
</div>

              <div class="flex sm:justify-start justify-center">
                <button
                  @click="addFileSurveyArea"
                  class=" text-white rounded p-2 bg-blue-500 ">
                  ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà
                </button>
              </div>
              <div class="flex sm:justify-start justify-center">
                <button
                  @click="addImgProcess"
                  class=" text-white rounded p-2 bg-blue-500 ">
                  ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏†‡∏≤‡∏û‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
                </button>
              </div>
              <div class="flex sm:justify-start justify-center">
                <button
                  @click="addImgTest"
                  class=" text-white rounded p-2 bg-blue-500 ">
                  ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö
                </button>
              </div>
              <div class="flex sm:justify-start justify-center">
                <button
                  @click="addImgDeliverJob"
                  class=" text-white rounded p-2 bg-blue-500 ">
                  ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏†‡∏≤‡∏û‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö‡∏á‡∏≤‡∏ô
                </button>
              </div>
              <div class="">
                <div class="pt-2 relative  text-gray-600">
                  <input
                    v-model="searchQuery"
                    class="border-2 w-full border-gray-300 bg-white h-10 px-3 rounded-lg text-sm focus:outline-none"
                    type="search"
                    name="search"
                    placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤"/>
                </div>
              </div>
            </div>

            <div class="flex-auto block py-8 pt-6 rounded-2xl">
              <div class="overflow-x-auto">
                <table
                  class="w-full my-0 align-middle text-slate-600 border-neutral-200">
                  <thead class="align-bottom">
                    <tr class="font-semibold text-xl text-black">
                      <th class="pb-3 text-center min-w-[100px]"></th>
                      <th class="pb-3 text-center min-w-[100px]"></th>
                      <th class="pb-3 text-center min-w-[100px]"></th>
                      <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÉ‡∏´‡∏°‡πà -->
                    </tr>
                  </thead>
                  <tbody>
                    <tr
                      v-for="(projectTypes, index) in filteredProjects"
                      :key="index"
                      class="border-t border-dashed">
                      <td class="pr-0 text-center">
                        <span
                          class="font-semibold text-light-inverse text-md/normal"
                          >{{ projectTypes.code }}</span>
                      </td>
                      <td class="pr-0 text-center">
                        <span
                          class="font-semibold text-light-inverse text-md/normal"
                          >{{ projectTypes.name }}</span>
                      </td>
                      <td class="pr-0 text-center">
                        <button
                          @click="editProject(projectTypes)"
                          class="px-3 py-2 m-1 bg-yellow-500 text-white rounded-lg hover:bg-yellow-700">
                          ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
                        </button>
                        <button
                          @click="confirmDelete(projectTypes._id)"
                          class="px-3 py-2 m-1 bg-red-500 text-white rounded-lg hover:bg-red-700">
                          ‡∏•‡∏ö
                        </button>
                      </td>
                    </tr>
                  </tbody>
                </table>
                <div class="flex justify-center mt-4">
                  <button
                    @click="previousPage"
                    :disabled="currentPage === 1"
                    class="px-4 py-2 mx-2 bg-gray-200 hover:bg-gray-300 rounded">
                    ‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤
                  </button>
                  <button
                    @click="nextPage"
                    :disabled="currentPage === totalPages"
                    class="px-4 py-2 mx-2 bg-gray-200 hover:bg-gray-300 rounded">
                    ‡∏´‡∏ô‡πâ‡∏≤‡∏ñ‡∏±‡∏î‡πÑ‡∏õ
                  </button>
                </div>
                <span class="px-4 py-2 flex justify-center"
                  >{{ currentPage }} ‡∏à‡∏≤‡∏Å {{ totalPages }}</span>

                <div v-if="isLoading" class="text-center">Loading...</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import axios from "axios";
import dayjs from "dayjs";
import "dayjs/locale/th";
import Dialog from "primevue/dialog";
import Swal from "sweetalert2";
import Sidebar from "primevue/sidebar";

export default {
  components: {
    Dialog,
    Sidebar,
  },
  data() {
    return {
      isAddFileSurveyArea: false,//‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà
      isAddImgProcess:false,//‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏π‡∏õ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
      isAddImgTest:false,//‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏π‡∏õ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö
      isAddImgDeliverJob:false,//‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏π‡∏õ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö‡∏á‡∏≤‡∏ô

      currentPage: 1, // ‡πÄ‡∏û‡∏¥‡πà‡∏° currentPage
      pageSize: 10, // ‡πÄ‡∏û‡∏¥‡πà‡∏° pageSize
      searchQuery: "", // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
      Detailsvisible: false,
      projects: [],
      employees: [],
      isLoading: false,
      
      showEditProjectModal: false, // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á Dialog ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
      newProject: {},
      editedProject: null, // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
      detailEmployee: null,
      image_iden: null, // ‡∏à‡∏∞‡πÄ‡∏Å‡πá‡∏ö base64 ‡∏Ç‡∏≠‡∏á‡∏£‡∏π‡∏õ‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô
      image_bank: null ,
      groupedRoles: [
        {
          label: "Germany",
          code: "DE",
          items: [
            { label: "Berlin", value: "Berlin" },
            { label: "Frankfurt", value: "Frankfurt" },
            { label: "Hamburg", value: "Hamburg" },
            { label: "Munich", value: "Munich" },
          ],
        },
      ],
    };
  },
  mounted() {
    this.fetchProjects();
    this.fetchEmployees();
  },
  computed: {
    filteredProjects() {
      const startIndex = (this.currentPage - 1) * this.pageSize;
      const endIndex = startIndex + this.pageSize;

      // ‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ‡∏ï‡∏≤‡∏°‡∏Ñ‡πà‡∏≤‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
      const filtered = this.projects.filter((project) => {
        return project.name
          ?.toLowerCase()
          .includes(this.searchQuery?.toLowerCase());
      });

      // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏ô‡πâ‡∏≤
      this.totalPages = Math.ceil(filtered.length / this.pageSize);

      // ‡πÅ‡∏ö‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤
      return filtered.slice(startIndex, endIndex);
    },
  },
  methods: {
     handleFileChange(event) {
    const file = event.target.files[0];
    if (!file) return;

    if (this.fileType === 'iden') {
      this.image_iden = file;
    } else if (this.fileType === 'bank') {
      this.image_bank = file;
    }
  },

  async getImageData() {
    try {
      const response = await axios.get(`${import.meta.env.VITE_VUE_APP_DECCAN}/get-images`, {
        headers: {
          'auth-token': localStorage.getItem('token')
        }
      });

      this.image_iden = response.data.image_iden;
      this.image_bank = response.data.image_bank;
    } catch (error) {
      console.error("‡πÇ‡∏´‡∏•‡∏î‡∏†‡∏≤‡∏û‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:", error);
    }
  },
    async fetchEmployees() {
      try {
        const { data } = await axios.get(
          `${import.meta.env.VITE_VUE_APP_DECCAN}/get`,
          {
            headers: {
              token: localStorage.getItem("token"),
            },
          }
        );
        if (data.status) {
          console.log(data.data);
          this.employees = data.data;
          this.fetchRoles();
        }
      } catch (err) {
        console.log(err);
      }
    },
    async fetchRoles() {
      try {
        const { data } = await axios.get(
          `${import.meta.env.VITE_VUE_APP_DECCAN}/role/getall`
        );
        if (data.status) {
          const originalRoles = data.data;
          console.log(originalRoles);
          this.groupedRoles = originalRoles
            .filter((r) => r.thai_position)
            .map((role) => {
              const result = {
                label: role.thai_position,
                code: role.position?.toLowerCase(),
                items: this.employees
                  .filter(
                    (ee) =>
                      ee.position &&
                      ee.position?.toLowerCase() ===
                        role.position?.toLowerCase()
                  )
                  .map((em) => {
                    return {
                      label: em.first_name,
                      value: em._id,
                    };
                  }),
              };
              return result;
            })
            .reduce((accumulator, current) => {
              if (!accumulator.some((item) => item.label === current.label)) {
                accumulator.push(current);
              }
              return accumulator;
            }, []);
          console.log(this.groupedRoles);
        }
      } catch (err) {
        console.log(err);
      }
    },
    previousPage() {
      if (this.currentPage > 1) {
        this.currentPage--;
      }
    },
    nextPage() {
      if (this.currentPage < this.totalPages) {
        this.currentPage++;
      }
    },

    async submitAddFileSurveyArea(event) {
      event.preventDefault();

      try {
        this.isLoading = true;
        const response = await axios.put(
          `${import.meta.env.VITE_VUE_APP_DECCAN}/project-types/${
            this.editedProject._id
          }`,
          this.editedProject,
          {
            headers: {
              "auth-token": localStorage.getItem("token"),
            },
          }
        );
        // ‡πÅ‡∏™‡∏î‡∏á SweetAlert2 ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
        await Swal.fire({
          icon: "success",
          title: "‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à",
          showConfirmButton: false,
          timer: 1500,
          customClass: {
            container: "project",
          },
        });
        // ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πà‡∏≠‡∏á Dialog ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
        this.showEditProjectModal = false;
        // ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ
        this.fetchProjects();
      } catch (error) {
        // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î
        console.error("Error Can't AddFile :", error);
        await Swal.fire({
          icon: "error",
          title: "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏î‡πâ",
          text: "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á",
        });
      } finally {
        this.isLoading = false;
      }
    },//‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô


    editProject(project) {
      this.editedProject = { ...project };
      this.showEditProjectModal = true; // ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á Dialog ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
    },
    viewDetails(project) {
      this.detailEmployee = project;
      this.Detailsvisible = true;
    },
    async confirmDelete(id) {
      const result = await Swal.fire({
        title: "‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö",
        text: "‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?",
        icon: "warning",
        showCancelButton: true,
        confirmButtonColor: "#d33",
        cancelButtonColor: "#3085d6",
        confirmButtonText: "‡∏•‡∏ö",
        cancelButtonText: "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å",
      });

      if (result.isConfirmed) {
        // ‡∏ñ‡πâ‡∏≤‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡∏•‡∏ö"
        try {
          const response = await axios.delete(
            `${import.meta.env.VITE_VUE_APP_DECCAN}/project-types/${id}`,
            {
              headers: { "auth-token": `${localStorage.getItem("token")}` },
            }
          );
          // Notify that the deletion was successful
          await Swal.fire({
            icon: "success",
            text: "‡∏•‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à",
            showConfirmButton: false,
            timer: 2000,
          });
          // Reload the project data
          this.fetchProjects();
        } catch (error) {
          // Notify if there's an error deleting
          console.error("Error deleting project:", error);
          await Swal.fire({
            icon: "error",
            title: "‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à",
            text: "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏ö‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ‡πÑ‡∏î‡πâ",
          });
        }
      }
    },

    async fetchProjects() {
      try {
        this.isLoading = true;
        const response = await axios.get(
          `${import.meta.env.VITE_VUE_APP_DECCAN}/project-types`,
          {
            headers: {
              "auth-token": localStorage.getItem("token"),
            },
          }
        );
        console.log(response.data);
        this.projects = response.data.data; // Change this line to assign to `this.projects`
      } catch (error) {
        console.error("Error fetching projects:", error);
      } finally {
        this.isLoading = false;
      }
    },
    addFileSurveyArea() {
      this.isAddFileSurveyArea = true;
    },//function‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà

    // handleFileChange(event) {
    //   this.selectedFile = event.target.files[0];
    // },
    // uploadFile() {
    //   if (!this.selectedFile) {
    //     return;
    //   }
    //   console.log('‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å:', this.selectedFile);
    //   // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡πà‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î
    //   this.selectedFile = null;
    // },
    //function‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î

    addImgProcess() {
      this.isAddImgProcess = true;
    },
    addImgTest() {
      this.isAddImgTest = true;
    },
    addImgDeliverJob() {
      this.isAddImgDeliverJob = true;
    },
    async submitProject(event) {
      event.preventDefault();
      try {
        this.isLoading = true;
        this.newProject.roles = this.newProject.roles?.map((p) => p.value);
        console.log(this.newProject);
        const response = await axios.post(
          `${import.meta.env.VITE_VUE_APP_DECCAN}/project-types`,
          this.newProject,
          {
            headers: {
              "auth-token": localStorage.getItem("token"),
            },
          }
        );
        if (response.data.status) {
          this.newProject = {};
          // ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πà‡∏≠‡∏á popup
          this.showAddProjectModal = false;
          // ‡πÅ‡∏™‡∏î‡∏á SweetAlert2 ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
          Swal.fire({
            icon: "success",
            title: "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à",
            showConfirmButton: false,
            timer: 1500,
          });
          // ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ
          this.fetchProjects();
        }
      } catch (error) {
        if (
          error.response &&
          error.response.data &&
          error.response.data.message === "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏"
        ) {
          // Handle specific error condition
          await Swal.fire({
            icon: "error",
            title: "‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à",
            text: error.response.data.message,
            showConfirmButton: false,
            timer: 1500,
            customClass: {
              container: "project",
            },
          });
        } else {
          // Handle other errors
          console.error("Error submitting project:", error);
        }
      } finally {
        this.isLoading = false;
      }
    },
  },
};
</script>
<style>
.project {
  z-index: 9999;

}
</style>
